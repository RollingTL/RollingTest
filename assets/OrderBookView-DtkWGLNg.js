import{h as S,j,g as D,k as E,d as A,l as J,a as g,b as i,e as l,w as c,u as y,F as I,m as P,n as $,p as R,r as w,o as x,f as N,t as p,q as M}from"./index-NpuWWS70.js";const W=S(100),F=function(){return{depth:W}},q="https://api.binance.com/api/v3/depth",d=S(),O=S("idle"),{depth:C}=F(),{selectedPair:z}=D(),L=function(){async function b(){O.value="loading";const o=`${q}?symbol=${z.value}&limit=${C.value.toString()}`;try{const r=await fetch(o);if(!r.ok)throw new Error("Network response was not ok");const h=await r.json();d.value=h,O.value="idle"}catch(r){throw O.value="idle",console.error("There was a problem with the fetch operation:",r),new Error("Network response has error")}}const u=async()=>{O.value!=="loading"&&(d.value=void 0,await b())},m=()=>{d.value=void 0},k=o=>{if(!d.value)return;for(;o.length>0;){const e=o.shift();if(e){if(!("u"in e)||!("U"in e))return;const v=e.u,_=e.U,t=d.value.lastUpdateId;_<=t+1&&v>=t+1&&(r(d.value.bids,e.b),r(d.value.asks,e.a),d.value.bids.sort((a,f)=>Number(f[0])-Number(a[0])),d.value.asks.sort((a,f)=>Number(a[0])-Number(f[0])),h(d.value.bids,C.value),h(d.value.asks,C.value),d.value.lastUpdateId=v+1)}}function r(e,v){for(const[_,t]of v)if(Number(t)===0){const f=e.findIndex(([B,U])=>B===_);f!==-1&&e.splice(f,1)}else{const f=e.findIndex(([B,U])=>B===_);f!==-1?e[f][1]=t:e.push([_,t])}}function h(e,v){e.length>v&&e.splice(0,e.length-v)}};return{orderBook:j(d),updateOrderBook:k,initOrderBook:u,clearOrderBook:m}},K=S([]),G=function(){return{depthUpdates:K}},H="wss://stream.binance.com:9443/ws/";let n;const Q=function(){const{orderBook:b,initOrderBook:u,updateOrderBook:m,clearOrderBook:k}=L(),{depthUpdates:o}=G(),{selectedPair:r}=D(),h=async()=>{n&&n.readyState!==n.CLOSED||(n=new WebSocket(H+r.value.toLowerCase()+"@depth"),n.onopen=()=>{setInterval(()=>{n.readyState===n.OPEN&&n.send(JSON.stringify({ping:Date.now()}))},18e4),n.send(JSON.stringify({method:"SUBSCRIBE",params:[`${r.value.toLowerCase()}@depth`],id:1}))},n.onmessage=_,n.onclose=()=>{},n.onerror=t=>{console.error("WebSocket error:",t)})},e=()=>{k(),n&&n.close()};function v(t,a){t.send(JSON.stringify({pong:a}))}async function _(t){b.value||await u();const a=JSON.parse(t.data);a.ping?v(this,a.ping):("e"in a&&a.e==="depthUpdate"&&o.value.push(a),m(o.value))}return E(()=>{e()}),{start:h,stop:e}},X={class:"h-screen h-sm-auto d-flex flex-column justify-start"},Y={class:"mt-16 pt-4"},Z={class:"depth-selector d-flex align-baseline"},ee={class:"text-subtitle-2 pr-1"},te={class:"pr-2"},se=R('<div class="" data-v-1633a807><div class="d-flex pt-4" data-v-1633a807><div class="flex-grow-1 pl-2 pr-2" data-v-1633a807><div class="head-table" data-v-1633a807><div class="grid-item first text-center text-sm-left" data-v-1633a807>Bid price</div><div class="grid-item second text-center text-sm-right" data-v-1633a807>Amount</div><div class="grid-item third text-center text-sm-right hidden-xs hidden-sm" data-v-1633a807>Value</div></div></div><div class="flex-grow-1 pl-2 pr-2" data-v-1633a807><div class="head-table" data-v-1633a807><div class="grid-item first text-center text-sm-left" data-v-1633a807>Ask price</div><div class="grid-item second text-center text-sm-right" data-v-1633a807>Amount</div><div class="grid-item third text-center text-sm-right hidden-xs hidden-sm" data-v-1633a807>Value</div></div></div></div></div>',1),oe={class:"overflow-y-scroll"},ae={key:0,class:"d-flex text-mono text-right pt-4 pb-8"},ne={class:"flex-grow-1 pl-2 pr-2"},ie={key:0},de={class:"grid-item first"},re={class:"grid-item second"},le={class:"grid-item third hidden-xs hidden-sm"},ce={class:"flex-grow-1 pl-2 pr-2"},ue={key:0},ve={class:"grid-item first"},_e={class:"grid-item second"},fe={class:"grid-item third hidden-xs hidden-sm"},pe={key:1,class:"ma-12 d-flex justify-center"},me=A({__name:"OrderBookView",setup(b){const{orderBook:u}=L(),{start:m,stop:k}=Q(),{depth:o}=F(),{selectedPair:r}=D();return m(),J(o,async()=>{k(),await new Promise(h=>{setTimeout(()=>{h()},1e3)}),m()}),E(()=>{k()}),(h,e)=>{const v=w("v-btn"),_=w("v-list-item-title"),t=w("v-list-item"),a=w("v-list"),f=w("v-menu"),B=w("v-card-title"),U=w("v-card"),T=w("v-progress-circular");return x(),g("div",X,[i("div",Y,[l(U,{elevation:"0",class:"position-relative"},{default:c(()=>[l(B,null,{default:c(()=>[N("Order Book "),i("div",Z,[i("div",ee,[i("span",te,p(y(r)),1),N(" Depth: ")]),l(f,null,{activator:c(({props:s})=>[l(v,M({variant:"tonal"},s),{default:c(()=>[N(p(y(o)),1)]),_:2},1040)]),default:c(()=>[l(a,null,{default:c(()=>[l(t,{value:100,onClick:e[0]||(e[0]=s=>o.value=100)},{default:c(()=>[l(_,null,{default:c(()=>[N(p("100"))]),_:1})]),_:1}),l(t,{value:500,onClick:e[1]||(e[1]=s=>o.value=500)},{default:c(()=>[l(_,null,{default:c(()=>[N(p("500"))]),_:1})]),_:1}),l(t,{value:1e3,onClick:e[2]||(e[2]=s=>o.value=1e3)},{default:c(()=>[l(_,null,{default:c(()=>[N(p("1000"))]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),se,i("div",oe,[y(u)?(x(),g("div",ae,[i("div",ne,[y(u)?(x(),g("div",ie,[(x(!0),g(I,null,P(y(u).bids,(s,V)=>(x(),g("div",{key:V+s[0],class:"data-table"},[i("div",de,p(s[0].slice(0,-2)),1),i("div",re,p(s[1].slice(0,-2)),1),i("div",le,p((Number(s[0])*Number(s[1])).toFixed(2)),1)]))),128))])):$("",!0)]),i("div",ce,[y(u)?(x(),g("div",ue,[(x(!0),g(I,null,P(y(u).asks,(s,V)=>(x(),g("div",{key:V+s[0],class:"data-table"},[i("div",ve,p(s[0].slice(0,-2)),1),i("div",_e,p(s[1].slice(0,-2)),1),i("div",fe,p((Number(s[0])*Number(s[1])).toFixed(2)),1)]))),128))])):$("",!0)])])):(x(),g("div",pe,[l(T,{size:60,indeterminate:""})]))])])}}}),he=(b,u)=>{const m=b.__vccOpts||b;for(const[k,o]of u)m[k]=o;return m},xe=he(me,[["__scopeId","data-v-1633a807"]]);export{xe as default};
